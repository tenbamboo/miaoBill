<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
		<meta name="mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">

		<link rel="icon" href="" type="image/x-icon" />
		<link rel="shortcut icon" href="" type="image/x-icon" />
		<title></title>
		<link rel="stylesheet" href="./lib/bootstrap/dist/css/bootstrap.min.css">
		<link rel="stylesheet" href="./lib/font-awesome/css/font-awesome.min.css">
		<link rel="stylesheet" href="./lib/animate/animate.min.css">
		<link rel="stylesheet" href="./lib/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css">
		
		
		
		<link rel="stylesheet" href="./css/main.css">
		<link rel="stylesheet" href="./css/style.css">
		<script src="./js/app.js"></script>
	</head>
	<body>
		<div class="fixHeader">
			<header>
				<h3></h3>
				<a class="leftBtn"><i class="fa fa-bars"></i></a>
				<!-- <i class="fa fa-arrow-left"></i> -->
				<a class="rightBtn"></a>
			</header>
		</div>
		<div id="mainContainer" class="">
		</div>
		<div class="slideBar animated ">
			<ul>
				<li>MiaoBill</li>
				<li><a pa-href="billList"><i class="fa fa-calculator"></i>账单</a></li>
				<li><a pa-href="chartList"><i class="fa fa-bar-chart"></i>图表</a></li>
				<li><a pa-href="billTypeList"><i class="fa fa-tag"></i>账单类型</a></li>
				<li><a><i class="fa fa-cloud-upload"></i>数据同步</a></li>
				<li><a><i class="fa fa-power-off"></i>退出APP</a></li>
			</ul>
		</div>
		<div class="overlay"></div>
		<i class="fa fa-spinner fa-pulse spinner"></i>

		<script src="./js/dao.js"></script>

		<script src="./lib/jquery/dist/jquery.js"></script>
		<script src="./lib/lovefield/lovefield.min.js"></script>
		<script src="./lib/bootstrap/dist/js/bootstrap.min.js"></script>
		<script src="./lib/artTemplate/artTemplate.js"></script>
		<script src="./lib/q.js"></script>
		<script src="./lib/jplusin/jquery.serializeJson.js"></script>
		<script src="./lib/jplusin/jquery.pajax.custom.js"></script>
		<script src="./lib/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js"></script>
		<script src="./lib/bootstrap-datetimepicker/js/bootstrap-datetimepicker.zh-CN.js"></script>
		<script src="./lib/hammer/hammer.min.js"></script>
		<script src="./lib/hammer/jquery.hammer.js"></script> 
		<script src="./lib/iscroll.js"></script>
		


		<script>
			var dao;
			dao=new Dao({
				schema:'miaoBill'
			});
			jQuery(document).ready(function($) {
				Index.initTool();
				Index.initEvent();
			});
			var Index={
				initEvent:function(){
					$("header").delegate('.fa-bars', 'click', function(){
						Index.showOverlay(false);
						$(".slideBar").css({'top':document.body.scrollTop}).show().removeClass('slideOutLeft').addClass('slideInLeft');
					});
					$("header").delegate('.fa-arrow-left', 'click', function(){
						$.pajax('back');
					});
					$(".slideBar a").click(function(){
						Index.hideOverlay();
					})
				},
				initTool:function(){
					$.pajax({
						defaultLoad:'billList'
					});
				},
				showOverlay:function(spinnerFlag){
					if(spinnerFlag){
						$(".spinner").show();
					}
					$(".overlay").height(document.body.scrollHeight).show();
					$('body').css({'overflow':'hidden'});
					$(".overlay").one('click',function(){
							Index.hideOverlay();
					});
				},
				hideOverlay:function(){
					$('body').css({'overflow':''})
					$(".overlay").hide();
					$(".spinner").hide();

					Q.fcall(function(){
						$(".slideBar").removeClass('slideInLeft').addClass('slideOutLeft')
						var deferred = Q.defer();
					    setTimeout(deferred.resolve, 500);
					    return deferred.promise;	
					}).then(function(s){
						$(".slideBar").hide();
					})
				}
			}





			/** 
			 * 对日期进行格式化， 
			 * @param date 要格式化的日期 
			 * @param format 进行格式化的模式字符串
			 *     支持的模式字母有： 
			 *     y:年, 
			 *     M:年中的月份(1-12), 
			 *     d:月份中的天(1-31), 
			 *     h:小时(0-23), 
			 *     m:分(0-59), 
			 *     s:秒(0-59), 
			 *     S:毫秒(0-999),
			 *     q:季度(1-4)
			 * @return String
			 * @author yanis.wang
			 * @see	http://yaniswang.com/frontend/2013/02/16/dateformat-performance/
			 */
			template.helper('dateFormat', function (date, format) {

			    date = new Date(date);

			    var map = {
			        "M": date.getMonth() + 1, //月份 
			        "d": date.getDate(), //日 
			        "h": date.getHours(), //小时 
			        "m": date.getMinutes(), //分 
			        "s": date.getSeconds(), //秒 
			        "q": Math.floor((date.getMonth() + 3) / 3), //季度 
			        "S": date.getMilliseconds() //毫秒 
			    };
			    format = format.replace(/([yMdhmsqS])+/g, function(all, t){
			        var v = map[t];
			        if(v !== undefined){
			            if(all.length > 1){
			                v = '0' + v;
			                v = v.substr(v.length-2);
			            }
			            return v;
			        }
			        else if(t === 'y'){
			            return (date.getFullYear() + '').substr(4 - all.length);
			        }
			        return all;
			    });
			    return format;
			});


		</script>
		<script id="billList_template" type="text/html">
			{{each list as n i}}
				<li>
					{{if n.billFlow =='cost'}}
						<i class="fa fa-minus-square"></i>
					{{else}}
						<i class="fa fa-plus-square"></i>
					{{/if}}
					<div class="billName">{{n.billName}}-{{n.billMoney}}</div>
					<div class="billTypeAndTime">
						<div class="fl">{{n.billType}}</div>
						<div class="fr">{{n.billTime | dateFormat:'yyyy-MM-dd'}}</div>
					</div>
					<div class="delBill">
						<i class="fa fa-trash"></i>
					</div>
				</li>
			{{/each}}
		</script>
	</body>

</html>